---
title: "Right Start for Colorado Annual Report"
subtitle: "FY2019 Report to Funders"
author: 
  Nicole Harty, MPH & Shannon Bekman, PhD, IMH-E
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  BiocStyle::html_document:
  toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, qwraps2_markup = "markdown")
library(kableExtra)
library(lubridate)
library(tidyverse)
library(likert)
#Set FY
FYlong = 'fiscal year 2019'
FYshort = 'FY19'

source('Initial_Training_Data_PrepAnalysis.R', echo = TRUE)
```

##Grantee Contact Information
**Grant Year:** `r FYlong`  
**Grantee Name:** Mental Health Center of Denver  
**Grant Number:**   
**Project Director Name:** Shannon Bekman, PhD, IMH-E  
**Preson(s) Completing Report:** Shannon Bekman, PhD, IMH-E; Nicole Harty, MPH; Michelle Roy, PhD, IMH-E

[Abbreviations Used in Report](#Abbreviations) <!--create appendix with abbreviations list! -->

#Executive Summary


#Program Description
The Mental Health Center of Denver (MHCD) began building family-centered I/ECMH programs over 20 years ago and now offers a mix of evidence-based prevention, early intervention and outpatient services. The program coordinates closely with the prevention/early intervention initiatives funded by Maternal and Child Health Title V funds at Denver Public Health (DPH); an MHCD staff member sits on DPH’s Maternal and Infant Mental Health Advisory Council. We also work with the home visiting program at Denver Health, which is funded by HRSA Maternal, Infant and Early Childhood Home Visiting funds. MHCD is now known as a state and regional expert in infant and early childhood mental health; however, our service array had not previously included an intensive, home-based option for families whose needs are greater than can be addressed in our outpatient program. The Right Start for Colorado program brings these intensive services to Denver, as there are no other organizations offering these services across the Denver Metropolitan area. 

Finally, although Colorado is a leader in infant and early childhood mental health (IECMH), workforce issues still present major challenges throughout the state. A 2013 environmental scan on the social and emotional health of young children found that “Colorado lacks adequate numbers of trained professionals . . . who have the specialized knowledge, skills, training and support they need in early childhood mental health to meet even the current demand for services.” <!--create references list--> (Hoover & Kubicek, 2013, p.15). This challenge encompasses not only the need to develop mental health clinical staff, but also to increase behavioral health awareness and knowledge among related early childhood providers. Although Colorado has implemented a number of training initiatives aimed at both these workforce populations over the past ten years, these have primarily been discrete short-term efforts. What has been lacking is the follow up and ongoing support that is necessary to assure that knowledge transformation occurs successfully and that participants’ skills are sustained and passed forward to others who join the workforce in the future.

Right Start for Colorado (RS-CO) is a five-year Substance Abuse and Mental Health Services Administration-funded (SAMHSA) initiative led by the Mental Health Center of Denver to support the growth and development of IECMH services in the State of Colorado. Additional funding comes from the Colorado Early Childhood Funders Community (Buell Foundation, Caring for Colorado Foundation, Communities First Foundation, Piton Foundation, Rose Community Foundation, and Zoma Foundation).

RS-CO staff have identified four programmatic goals:

1. Address the statewide shortage of mental health professionals with IECMH expertise by creating communities of practice to support ongoing sustainability of high-quality services throughout Colorado.
2. Help a wide array of other providers in the state who routinely work with children ages 0-5 develop greater knowledge and expertise in IECMH.
3. Ensure that children ages 0-5 and families in metro Denver have access to the full continuum of IECMH services (MH promotion, prevention, early intervention, and treatment).
4. Improve the Mental Health Center of Denver’s infrastructure for service to children and families by modifying the EHR to include the DC0:5 diagnostic tool.

To accomplish these goals, the RS-CO team is comprised of a Project Direct, Clinical Program Manager, two home-based clinicians, and an executive assistant. They partner closely with a variety of community organizations and rely upon evaluation services within the Mental Health Center of Denver’s Information Systems department.

In addition to expanding MHCD’s service array for infants, young children and families in our local community, RS-CO intends to improve the lives of others who need these services through statewide efforts that are identified in and aligned with the state’s ECMH Strategic Plan. A previous gap in supporting the IECMH workforce has been that while many trainings have been provided, ongoing, sustainable support is unavailable in most Colorado communities, particularly in rural areas. This proposal employs communities of practice to develop resources within under-supported areas to allow for future sustainability. Finally, to improve I/ECMH awareness, knowledge and skills among child welfare case workers, home visitors, early care and education providers, pediatricians and other providers who regularly come into contact with infants, young children and their families, RS-CO will conduct a needs assessment and develop a training plan for these providers.

The success and sustainability of this project will depend on the extent to which supports and services can be institutionalized and accessible to young children, families and providers in metro Denver and statewide. 


#Program Activities
In accordance with the SAMHSA Infant and Early Childhood Mental Health Grant Program guidelines, Right Start for Colorado encompasses a range of activities aimed to impact individual, family, community, and statewide IECMH services in Colorado.

##Mental Health Promotion, Prevention & Screening
###Project Activities

###Major Accomplishments
Broadly, exceeded annual goals (partially because we were thinking we'd count families as one unit rather than each family member)
Hired & onboarded two well-qualified clinicians
Number of children and caregivers screened
Number of children and families accessing services
Implemented processes to track changes in outcomes associated with clinical treatment
Quality of referrals is good - people are calling asking specifically for home-based and they seem appropriate

###Challenges/Barriers
Identifying families most appropriate for home-based vs outpatient services
Logistics of being efficient in providing home-based services to meet families where they are (geographically and psychologically) in a large city with congested traffic

###Solutions/Lessons Learned
Limiting # behavioral health assessments home-based clinicians complete because those are done on-site at an MHCD facility

###Progress Toward Sustainability
Home-based clinicians' caseloads have grown to near capacity. Program staff are beginning to compare data between the outpatient and home-based levels of service so as to contine to refine service delivery. A component of this program refinement is to incorporate the ESCI to idenitfy level of service at the time of mental health services screening (the behavioral health assessment).

##Mental Health Consultation
Although idenified as a focus area of the Grant Program, RS-CO has chosen to incorporate the other three activity areas outlined in the grant announcement.

##Trainings for Mental Health Clinician and Other Child- and Family-serving Providers
###Project Activities

###Major Accomplishments
Broadly, exceeded annual goals for number of people trained
Receiving substantial additional funding from local foundations to support and expand our needs assessment

###Challenges/Barriers
Maintaining follow-up with clinicians and allied professionals after trainings (due to job changes and contact info changes)

###Solutions/Lessons Learned

###Progress Toward Sustainability
Needs assessment should help insure sustainability of training 


##Systems Improvements
###Project Activities
DC05 programming; advocating for broader use and application of DC05 in community mental health

###Major Accomplishments
OBH & HCPF approval of DC05 - no cross-walk??

###Challenges/Barriers

###Solutions/Lessons Learned

###Progress Toward Sustainability



#Performance Data and Evaluation

##Evaluation Approach
The RS-CO team has identified four questions to guide their evaluation efforts:

* To what extent does implementing a comprehensive training plan support ongoing sustainability of high-quality IECMH services in Colorado?
* To what extent has RS-CO increased knowledge and expertise in IECMH among non-behavioral health providers?
* How has RS-CO changed/impacted access to the full continuum of IECMH services across Colorado?
* To what extent has the Mental Health Center of Denver’s infrastructure for serving children and families improved?
The evaluation metrics outlined within the Evaluation Plan Table are intended to provide a comprehensive story of RS-CO’s services to provide an answer to each these four evaluation questions. Data is collected through both regular organizational workflows as well as workflows and data entry specific to this program. Data reporting and analysis systems are set up to report on all routinely updated indicators. Data analysis is overseen by the RS-CO Lead Evaluator and is completed by the Applied Research Team.

The sustainability goal of the RS-CO workforce development activities is that what existed at the start of the grant continues and the efforts of the grant have led to active community champions. Dissemination of the learnings over the course of this five-year grant will be shared with a variety of stakeholders across the state and nationally.

The RS-CO project team developed a logic model to guide its evaluation efforts. Because the mechanisms by which RS-CO provides activities related to workforce development and allied provider trainings are separate from the mechanisms by which it provides activities related to clinical services, the logic model is presented in two separate diagrams in addition to the master logic model. All three of these models are presented in [Appendix 2](#Eval-Plan-Table). Right Start for Colorado Logic Model. The RS-CO logic model is presented as inputs, activities, outputs, short-term outcomes, intermediate-term outcomes, and long-term outcomes. Each component of the logic model is color-coded as relating to Clinical Expansion, Clinical Workforce Development, Non-Clinical Workforce Development, and Evaluation. The logic model describes which inputs and resources enable specific activities, which outputs results from specific activities, and how each output is linked to short-term, intermediate-term, and long-term outcomes. All activities and related outcomes relate back to a specific programmatic goal. All **Clinical Expansion** activities lead towards *long-term decreases in mental disturbances in very young children*, and all **Workforce Development** activities lead towards the *sustainability of Colorado’s IECMH workforce* as well as *long-term decreases in mental disturbances in very young children*.

[Evaluation Plan Table - Master](#Eval-Plan-Table) provides an overview of the full evaluation plan. The evaluation questions are included on the top, and the activities related to the Right Start for Colorado program are detailed on the left side. The overview included in [Appendix 2](#Eval-Plan-Table) includes the process, short/medium-term, and long-term measures and metrics. Additional details on the measurement methods, goals, reporting frequency, and reporting start date are available in the <!--Provide link to OneDrive or some link for Eval Plan - for MHCD staff only or public?-->Full Evaluation Plan Table.

The evaluation metrics outlined within the Evaluation Plan Table are intended to provide a comprehensive story of RS-CO’s services to provide an answer to each these four evaluation questions. The metrics are grouped within 6 objectives aligned to the workforce development, clinical services expansion, dissemination, and sustainability. There are four total tables within the Evaluation Plan Table: Master describes the process, short/medium-term, and long-term outcomes associated with each objective, including the specific metric and measurement method; Process, Short Term, and Long Term each provide additional details for each metric including the goal, first grant quarter reported, reporting frequency, and location of the data/measure.



##SPARS{#SPARS}
Narrative to introduce

The SAMHSA Performance Accountability and Reporting System (SPARS) metrics

Table from SAMHSA report guidance <!-- update this table from quarterly reporting summary excel file-->

SPARS Indicator | Annual Goal | Actual | Percent of Goal Met
------------ | ------------- | ------------- | -------------
WD2 | 50 | 198 | 396%
T3 | 25| 34 | 136%
S1 | 100| 351 | 351%
R1 | 40 | 103 | 258%
AC1 | 75% | 72% | 96%
<!--are we including just allied or allied and clinican? our goal specificied just allied trainees. but I think we report all.. that's what I have-->

We have well surpassed our goals for WD2, S1, and R1 because we set our goals based upon counting each family served as one individual rather than couting each individual child and caregiver as a unique individual. We are slightly below target for our AC1 goal. We believe this is partially due to the fact that individuals referred towards the end of the quarter did not engage in services until after the reporting period ended. Additionally, when we submitted our goals, we were thinking specifically of referrals to our home-based team. The additional SPARS guidance received during quarter 3 indicated that we are to track all referrals to any mental health or related services made on behalf of *anyone* receiving services as a result of the grant. We have updated our goals for subsequent years to more accurately capture our planned work.

##Additional Evaluation Efforts

###Clinical Services Expansion
The clinical expansion process measures include hiring and retaining home-based clinicians, processing referrals, screening for behavioral health needs in young children, and performing social-emotional, developmental, behavioral, and caregiver stress assessments. The SPARS metrics of screenings, referrals, receiving services, and delivery of evidence-based practices are included in the RS-CO clinical expansion process measures and are included in the [SPARS Section](#SPARS).

The short-term measures for clinical expansion include assessment of the increase in MHCD’s capacity to provide high-intensity infant mental health services, services received by children and families, and results of baseline clinical assessments. The clinical expansion long-term measures include satisfaction with services, treatment outcomes, changes in social-emotional skills and functioning, changes in problem behaviors, and changes in caregiver stress. 

###Workforce Development
Right Start for Colorado is primarily focused on increasing the *statewide* availability of quality IECMH services. Therefore, grant activities as well as evaluation efforts are heavily focused on the delivery of high-quality, relevant, and necessary trainings to clinical IECMH and allied professionals across Colorado. The statewide IECMH training needs assessment conducted in years one and two informs the types, frequency, and location of trainings provided over the course of the five-year grant. In the first year, RS-CO delivered trainings throughout Metro Denver in order to 1) refine training curricula and 2) capitalize on RS-CO staff's strong community partnerships to provide initiatl offerings high-demand trainings. Workforce development activities in years two through five include recruiting and facilitating communities of practice among clinical IECMH providers and delivering clinical and allied professional trainings in high-need, high-readiness communities across Colorado.

RS-CO has a data management system that tracks all registrations for trainings along with attendance at the trainings and responses to evaluations and pre/post tests for each training. Since quarter three of fiscal year 2019, all clinical and allied professionals trained through the grant register for each training, at which point they provide demographic information. All trainings wrap up with an evaluation the training that asks participants to rate 5 domains (satisfaction, instruction, relationships, and learning objectives) and respond to four open-ended questions. An example training evaluation is provided in [Appendix 3](#Training-Eval-Example). When trainings are provided by organizations with their own evaluation, RS-CO works with the training provider to incorporate our evaluation. Infrequently, this means that sections of the standard RS-CO evaluation are excluded. Content-heavy trainings without independent curriculum development and assessment (i.e. DC: 0-5 training) are accompanied by a pre/post test to assess knowledge acquisition. Participants in trainings lasting at least one full day are sent a follow-up evaluation survey six months after the training to assess knowledge retention and ongoing training needs. Each of these evaluations informs future training offerings.

```{r label = TrainingDescriptives, echo = FALSE, results='hide', message=FALSE, warning=FALSE}
###Types of Analysis - DESCRIPTIVES###
#time bound all data as per quarter, per year, and grant to date

##AVG # Trainings per ParticipantID
RegistDemo %>%
  filter(Attended=='Yes') %>%
  group_by(ParticipantId) %>%
  summarise(Count = n_distinct(TrainingName)) %>%
  summarise(AvgCount = mean(Count))

#number participants per training
RegistDemo %>%
  filter(Attended=='Yes') %>%
  group_by(ClinicalProfessional, TrainingName) %>%
  count(FiscalYear, TrainingName) %>%
  print(n = Inf)

#need to reorder the factors for County - depends upon which counties included
# levels = c("HSR 1: Logan, Morgan, Phillips, Sedgwick, Washington and Yuma Counties",
#            "HSR 2: Larimer County",
#            "HSR 3: Douglas County",
#            "HSR 4: El Paso County",
#            "HSR 5: Cheyenne, Elbert, Kit Carson and Lincoln Counties",
#            "HSR 6: Baca, Bent, Crowley, Huerfano, Kiowa, Las Animas, Otero and Prowers Counties",
#            "HSR 7: Pueblo County",
#            "HSR 8: Alamosa, Conejos, Costilla, Mineral, Rio Grande and Saguache Counties",
#            "HSR 9: Archuleta, Dolores, La Plata, Montezuma and San Juan Counties",
#            "HSR 10: Delta, Gunnison, Hinsdale, Montrose, Ouray and San Miguel Counties",
#            "HSR 11: Jackson, Moffat, Rio Blanco and Routt Counties",
#            "HSR 12: Eagle, Garfield, Grand, Pitkin and Summit Counties",
#            "HSR 13: Chaffee, Custer, Fremont and Lake Counties",
#            "HSR 14: Adams County",
#            "HSR 15: Arapahoe County",
#            "HSR 16: Boulder and Broomfield Counties",
#            "HSR 17: Clear Creek, Gilpin, Park and Teller Counties",
#            "HSR 18: Weld County",
#            "HSR 19: Mesa County",
#            "HSR 20: Denver County",
#            "HSR 21: Jefferson County")

RegistDemo$County <- fct_relevel(RegistDemo$County, "HSR 2: Larimer County",
           "HSR 4: El Paso County",
           "HSR 10: Delta, Gunnison, Hinsdale, Montrose, Ouray and San Miguel Counties",
           "HSR 11: Jackson, Moffat, Rio Blanco and Routt Counties",
           "HSR 12: Eagle, Garfield, Grand, Pitkin and Summit Counties",
           "HSR 14: Adams County",
           "HSR 15: Arapahoe County",
           "HSR 16: Boulder and Broomfield Counties",
           "HSR 17: Clear Creek, Gilpin, Park and Teller Counties",
           "HSR 18: Weld County",
           "HSR 19: Mesa County",
           "HSR 20: Denver County",
           "HSR 21: Jefferson County")

kable(RegistDemo %>%
        filter(Attended=='Yes') %>%
        group_by(County) %>%
        summarise(n = n()) %>%
        mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Geographic Representation of Training Participants") %>%
  kable_styling(full_width = F)

#number of distinct organizations represented at trainings
##**this will require re-naming organizations. **need to decide the best way to do this; some code already in QuarterlySPARS.R
#We don't want to share this info, probably. Need to decide best way

#numbers who attended trainings
AttendeesCount <- RegistDemo %>%
  filter(Attended=='Yes', FiscalYear=='FY19') %>%
  group_by(TrainingTopic) %>%
  summarize(Registrants = n_distinct(ParticipantId))
#numbers who responded to evals
EvalResponseCount <- EvalsWdemos %>%
  drop_na(EvalPartID) %>%
  filter(FiscalYear=='FY19') %>%
  group_by(TrainingTopic) %>%
  summarize(Responses = n_distinct(EvalPartID))

#response rate for trainings
AttendeesCount %>%
  left_join(EvalResponseCount, by = ("TrainingTopic" = "TrainingTopic")) %>%
  mutate(Percent = Responses/Registrants,Percent=scales::percent(Percent)) 

#minimum response rate for a training
AttendeesCount %>%
  left_join(EvalResponseCount, by = ("TrainingTopic" = "TrainingTopic")) %>%
  summarise(scales::percent(min(Responses/Registrants))) 
```

####Process Measures
The process measures for workforce development include completion of the needs assessment, recruiting and engaging participants for clinical communities of practice, hosting trainings for clinical and allied professionals, and maintaining partnerships with graduate training programs. The SPARS workforce development metric is included within the RS-CO workforce development process measures.
<!--Update this paragraph annually-->
RS-CO contracted with a local health policy research group to conduct its statewide training needs assessment. This contract extends into quarter two of year two and encompasses literature review, secondary data analysis, primary data collection through interviews, surveys, and focus group, and development of training recommendations. These training recommendations will include identification of participants in the clinical communities of practice and regions in which to prioritize delivery of trainings.

During **`r FYlong`**, RS-CO provided trainings to **`r RegistDemo %>% filter(Attended=='Yes', FiscalYear==FYshort, ClinicalProfessional=='Yes') %>% count()`** clinical IECMH professionals and **`r RegistDemo %>%  filter(Attended=='Yes', FiscalYear==FYshort, ClinicalProfessional=='No') %>% count()`** allied professionals. A summary of these trainings is available in **Table 1**. An additional 13 clinical and 11 allied professionals attended a care equity training during quarter two of fiscal year 2019, prior to the implementation of a data management system. Data analysis and reporting provided in this report excludes these 24 individuals.
 
``` {r label = TrainingTopicsCurrentFY, echo = FALSE}
kable(RegistDemo %>%
  filter(Attended=='Yes', FiscalYear==FYshort) %>%
  group_by('Topic' = TrainingTopic) %>%
  summarise('Number of Trainings' = n_distinct(EndDate), 'Number of Participants' = n_distinct(ParticipantId)), 
            caption = "Number of Participants and Trainings per Training Topic", align = "c") %>%
  kable_styling(full_width = F) %>%
  footnote(general = "DDHS = Denver Department of Human Services")
```
<!-- ADD THIS IN FOR FUTURE YEARS
To date, **`r RegistDemo %>% filter(Attended=='Yes', ClinicalProfessional=='Yes') %>% count()`** clinical IECMH professionals and **`r RegistDemo %>%  filter(Attended=='Yes', ClinicalProfessional=='No') %>% count()`** allied professionals have been trained.
{r label = "Trainings by training topic grant to date", echo = FALSE, results = 'asis'}
#number trainings of each type offered (by TrainingType)
kable(RegistDemo %>%
  filter(Attended=='Yes') %>%
  group_by('Topic' = TrainingTopic, 'Fiscal Year' = FiscalYear) %>%
  summarise('Number of Trainings' = n_distinct(EndDate), 'Number of Participants' = n_distinct(ParticipantId)), 
            caption = "Grant-to-Date Number of Participants and Trainings per Training Topic", align = "c") %>%
  kable_styling(full_width = F) %>%
  footnote(general = "DDHS = Denver Department of Human Services"
          )
-->

All training participants are required to register for each training so that we may capture demographic information about all participants including age, gender identity, race/ethnicity, geographic region serviced, experience working with the birth to five population, role within organization/employer, and reason for attending the training. Infrequently, various demographic information is unavailable for a participant. <!--UPDATE THE SUBSEQUENT TEXT BASED UPON DEMOGRAPHIC RESULTS EACH YEAR--> During `r FYlong`, about 70% of training participants were 25-44 years old; most (73%) were of white/non-Hispanic ethnicity; two-thirds (68%) were allied, non-clinical, professionals; half (58%) primarily provide services in the City and County of Denver; and one-third (33%) work as a mental health clinician. Most chose to participate in order to gain new information/knowledge (57%). The demographic breakdown of training participants is depicted in [Appendix 4](#Training-Demographics).


####Short-term and Long-term Measures
The short-term measures for workforce development include the listing of trainings in the training plan, summary of trainings and topics, short-term integration of knowledge into practice, training evaluation results, number of clinical psychology trainees, and number of hours of intensive training received by trainees. The long-term measures for workforce development include change in knowledge and competencies, integration of knowledge into practice, and likelihood of continuing in IECMH field among graduate trainees. 

``` {r label=LikertPrep, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
###Types of Analysis - STATISTICS###
# % agree or strongly agree to Satisfaction, Instruction, Relationships, Learning Objectives, Overall on eval
# compare % agree or strongly agree across trainings

#currently looks at ALL, not separated by fiscal year. NEED TO UPDATE THIS *****


#recode domains to factors
Evaldomains[,6:9] <- lapply(Evaldomains[,6:9], as.character)
Evaldomains[,6:9] <- lapply(Evaldomains[,6:9], factor, levels=c("1", "2", "3", "4", "5"))

##relevel this **************
levels(DC05prepost$Timepoint)
#can name as "1-Post" or relevel

#removing TrainingTopic=NA because there's three rows with no data
Evaldomains <- Evaldomains %>%
  filter(!is.na(TrainingTopic))
```

``` {r label=likertAnalysisEval, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
#Likert plots for domains, by training

##******move code for plots to best place in text********
library(likert)
PlotDomains <- likert(Evaldomains[,c(6:9)], grouping = Evaldomains$TrainingTopic)
plot(PlotDomains)
summary(PlotDomains)

#looking at learning objectives for each training - Are respondents consistently "not getting" one of them?
LearningObjectives <- EvalsWdemos %>%
  filter(!is.na(TrainingTopic)) %>%
  select(EvalPartID, TrainingName, TrainingTopic, StartDate, EndDate, LearningObj1, LearningObj2, LearningObj3, LearningObj4, 
         `Reason for Attending`, Gender, Ethnicity, Organization, Language, County, Education, Experience, Role, Age, 
         Attended, ClinicalProfessional, FiscalYear)
PlotLearningObjectives <- likert(LearningObjectives[,c(6:9)], grouping = LearningObjectives$TrainingTopic)
plot(PlotLearningObjectives)

##***FINDING: Tenets LO4 lower than other LO
#Check into what might be driving differences in Learning Objectives, Relationships, and Satisfaction
#Could just be due to training topic
##stratifying eval results (each domain) by demographics
###currently missing demographics for a lot of eval results so this might not be valuable to include in FY19 report

###******DO THIS WITH LIKERT PLOTS FOR % BY DEMOGRAPHICS*******

#reorder factor levels for better plots
levels(Evaldomains$Ethnicity)

Evaldomains$Ethnicity <- Evaldomains$Ethnicity %>%
  fct_relevel("Asian", "Black or African American", "Hispanic or Latinx", "Native Hawaiian or Other Pacific Islander", "White/Non-Hispanic", "Other", 
              "Two or More Ethnicities", "Prefer to Self-Describe", "Prefer Not to Answer", "Missing")
Evaldomains$Language <- Evaldomains$Language %>%
  fct_relevel("English", "Spanish")
Evaldomains$Experience <- Evaldomains$Experience %>%
  fct_relevel("11+", after = 4)
Evaldomains$Role <- Evaldomains$Role %>%
  fct_relevel("Other", after = 11)


likert(Evaldomains[,c(6:9)], grouping = Evaldomains$`Reason for Attending`) %>%
  plot()

likert(Evaldomains[,c(6:9)], grouping = Evaldomains$Experience) %>%
  plot()

likert(Evaldomains[,c(6:9)], grouping = Evaldomains$Role) %>%
  plot()

EvalDomainsClinican <- Evaldomains %>%
  filter(!is.na(ClinicalProfessional)) 
likert(EvalDomainsClinican[,c(6:9)], grouping = EvalDomainsClinican$ClinicalProfessional) %>% plot()

#adding N to likert plot: https://stackoverflow.com/questions/39058175/adding-sample-n-values-to-likert-plot-in-r
library(reshape2)
countsReasons = Evaldomains %>%
  select("Reason"=`Reason for Attending`, 6:9) %>% 
  melt(id.var="Reason", variable.name="Domain") %>%
  count(Reason, Domain) %>%
  mutate(variable=NA)

DomainsReasonPlot <- likert(Evaldomains[,c(6:9)], grouping = Evaldomains$`Reason for Attending`)
plot(DomainsReasonPlot) + 
  geom_text(data=countsReasons,
            aes(label=format(n,big.mark=","), x=Reason, y=145), 
            size=2.5, colour="grey30", hjust=1) +
  scale_y_continuous(limits=c(-100,150)) +
  coord_flip(ylim=c(-110,150)) +
  theme(plot.margin=unit(c(0.2,4,0.2,0.2),"cm"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

##code to put counts as separate table
library(gridExtra)
# TRY TO GET THIS TO WORK!!!
#   tt <- ttheme_default(
#   core=list(fg_params=list(fontsize=9)),
#   colhead=list(fg_params=list(fontsize=9)),
#   rowhead=list(fg_params=list(fontsize=9)))
# 
# grid.arrange(plot(DomainsReasonPlot),
#              arrangeGrob(nullGrob(),
#                          textGrob("Number of Responses", 
#                                   gp=gpar(fontsize=11,fontface="bold")),
#                          tableGrob(Evaldomains %>% 
#                                      count("Reason"=`Reason for Attending`) %>%
#                                      mutate(n=format(n, big.mark=",")), 
#                                    theme=tt, rows=NULL),
#                          nullGrob(),
#                          heights=c(15,1,5,15)),
#              widths=c(3,1))

##stratifying eval results for specific trainings by demographics
###this is limited to just a handful of the trainings because we don't have participant IDs for all eval results
###(partially due to developing data collection and management systems while collecting data)

#ANOVA to test differences in survey results by TrainingTopic
#*Don't do ttests for this stuff yet - it's not meaningful
#need responses as numeric (domains)
EvaldomainsNum <- Evaldomains
EvaldomainsNum[,6:10] <- lapply(EvaldomainsNum[,6:10], as.numeric)


#in future years, when have more data, look at differences by demographics within specific trainings.
```

``` {r label=DC05evalAnalysis, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
#reorder Timepoint levels
levels(DC05prepost$Timepoint)
DC05prepost$Timepoint <- DC05prepost$Timepoint %>%
  fct_relevel("Post", after = Inf)

DC05evalDomainsNum <- EvaldomainsNum %>%
 filter(TrainingTopic=="DC:0-5")
DC05demosSatisfaction <- lm(Satisfaction ~ ClinicalProfessional, data=DC05evalDomainsNum)
summary(DC05demosSatisfaction)
#FINDINGS: 1) NO difference in satisfaction based upon reason for attending
#          2) clinical professional = Y has statistically higher satisfaction score (p=.031), on average .55 points higher (of 5pt scale)

#getting errors for columns not having same number of levels when running likert
# DC05evalDomains <- Evaldomains %>%
#   filter(TrainingTopic=='DC:0-5')
# likert(DC05evalDomains[,c(6:8)], grouping = DC05evalDomains$Education) %>% plot()
```

FINDING: Tenets LO4 lower than other LO
stratifying eval results by demographics is limited to just a handful of the trainings because we don't have participant IDs for all eval results
(partially due to developing data collection and management systems while collecting data)

``` {r label=DC05prepostAnalysis, echo = FALSE, results='hide', message=FALSE, warning=FALSE}
#DC05 PRE/POST ANALYSIS
#change remaining variables to factor
DC05prepost[,42:43] <- lapply(DC05prepost[,42:43], as.factor)

#relevel Timepoint
levels(DC05prepost$Timepoint)
DC05prepost$Timepoint <- DC05prepost$Timepoint %>%
  fct_relevel("Post", after = Inf)

#calculate total score for pre/post test
DC05prepost <- DC05prepost %>%
  mutate(TotalScore = rowSums(.[4:17]), TotalPercent = TotalScore/14)

# did people change? Maintain?
lm(TotalPercent ~ Timepoint, data = DC05prepost) %>% summary()
#FINDING: Post scores are 29.6 percentage points higher than Pre scores, but not all variance explained
lm(TotalPercent ~ Timepoint + ClinicalProfessional, data = DC05prepost) %>% summary() #adding ClinicalProfessional improves
lm(TotalPercent ~ Timepoint + ClinicalProfessional + Timepoint*ClinicalProfessional, data = DC05prepost) %>% summary() #adding interaction doesn't improve
lm(TotalPercent ~ Timepoint + ClinicalProfessional + Experience, data = DC05prepost) %>% summary()  #adding experience improves, with stat signif for 7-10 and 11+ (maybe lump groups?)
lm(TotalPercent ~ Timepoint + ClinicalProfessional + Experience + TrainingName, data = DC05prepost) %>% summary() #adding training name doesn't improve
#lm(TotalPercent ~ Timepoint + ClinicalProfessional + Experience + Education + Experience*Education, data = DC05prepost) %>% summary() #Education and Educ/Exp interaction doesn't improve
#lm(TotalPercent ~ Timepoint + ClinicalProfessional + Experience + Age, data = DC05prepost) %>% summary() #adding Age improves - what does this mean? how big are groups?
#Gender and Ethnicity don't have large enough N to be meaningful; Reason for Attending isn't significant

# Who decreases?
# DC05prepost %>%
#   [change to wideform] %>%
#   mutate(ScoreChange = ) %>%
#   filter(ScoreChange<0)

# Can we stratify demographics for those who didn't change 

# Systematically getting a question wrong?

# Anything everyone gets right on pre-test?


#create additional eval df, rename eval question columns
##*****FUTURE: ADD DC05 FOLLOWUP SURVEY RESPONSES TO THIS!!****## 
DC05postEval <- DC05prepost %>%
  filter(Timepoint=="Post") %>%
  rename("Prior Understanding" = "EvalQ1", "Prior Confidence" = "EvalQ2", "Post Understanding" = "EvalQ3", 
         "Post Confidence" = "EvalQ4", "Anticipate Using" = "EvalQ5", "Anticipate Diagnosing" = "EvalQ6")
DC05postEval[,18:23] <- lapply(DC05postEval[,18:23], as.character)
DC05postEval[,18:23] <- lapply(DC05postEval[,18:23], factor, levels=c("1", "2", "3", "4", "5"))

#plot eval responses
DC05evalLikert <- likert(DC05postEval[,18:23])
plot(DC05evalLikert, group.order=c("Prior Understanding", "Post Understanding", "Prior Confidence",
                                   "Post Confidence", "Anticipate Using", "Anticipate Diagnosing"))
"summary"(DC05evalLikert, center = (DC05evalLikert$nlevels - 1)/2 + 1, ordered = FALSE)
# Confidence and understanding - changes in pre/post and compare to follow-up
#FINDING: Understanding and Confidence both shifted a lot; understanding shifted more
```

###Dissemination and Sustainability
Activities related to dissemination and sustainability include sharing information about the Right Start for Colorado grant, building relationships with the Colorado Behavioral Healthcare Council, and assessing program costs; disseminating the needs assessment, sharing grant updates and clinical best practices with relevant stakeholders, a crosswalk of the needs assessment and trainings provided, identification of regional champions, and pre/post comparison of billable service hours; and sharing training results and the 3-year change in capacity, needs, and barriers.

Dissemination of the learnings over the course of this five-year grant will be shared with a variety of stakeholders across the state and nationally via channels such as the RS-CO website, listserv/newsletter, community meetings, and relevant mental health, early childhood, and/or public health conferences. RS-CO program staff envision these learnings to include best practices in providing home-based services and determining level of care for very young children and their families; identification of need, capacity, and readiness for IECMH workforce development across Colorado; findings from delivering a variety of IECMH trainings; and challenges encountered while doing this work.

Sustainability of the *clinical services expansion* is dependent upon service volume among the home-based staff and documenting the total program cost and outcomes relative to the outpatient program. At the outset of this grant, the RS-CO Program Director and Manager are confident in the sustainability of this aspect of the grant. They view the grant as supporting the ramp-up and refinement of service delivery to this high-need population.

Sustainability of the *workforce development activities* is dependent upon clinicians and allied professionals who are trained by the grant remaining in similar roles within their Colorado community. The sustainability goal of the RS-CO workforce development activities is that what existed at the start of the grant continues and the efforts of the grant have led to active community champions. That is to say, communities across Colorado have identified leaders or champions of IECMH services, a robust system for identification, referral, and treatment of mental health disturbances in very young children, and the growth of dedicated IECMH programs at community mental health centers across the state. We intend to measure our success in this regard by re-assessing need and growth of IECMH service availability across the state through a small follow-up needs assessment in years four and five of the grant (2022-2023).



##Disparities Impact Strategy
```{r label = DISethnicity, echo = FALSE}
kable(RegistDemo %>%
  filter(Attended=='Yes') %>%
  group_by(Ethnicity) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Ethnicity Breakdown of Training Participants") %>%
   kable_styling(full_width = F)
```
``` {r label = DISgender, echo = FALSE}
kable(RegistDemo %>%
  filter(Attended=='Yes') %>%
  group_by(Gender) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Gender Breakdown of Training Participants") %>%
   kable_styling(full_width = F)
```

The following table summarizes our progress towards meeting the goals outlined in our Disparity Impact Statement, as specific to our home-based clinical services.
<!-- pull table from Annual_GoalsandDIS.R -->

The following table summarizes our progress towards meeting the goals outlined in our Disparity Impact Statement, as specific to our workforce development activities.
<!-- pull table from Annual_GoalsandDIS.R -->

#Looking Ahead


###Appendix 1: Abbreviations Used in Report{#Abbreviations}

###Appendix 2: Evaluation Plan Table{#Eval-Plan-Table}

###Appendix 3: Example Training Evaluation{#Training-Eval-Example}

###Appendix 4: Training Participant Demographics{#Training-Demographics}
``` {r label = age, echo = FALSE}
#breakdown of demographics of participants (just annually)
##**decide if counting participants more than once if attended multiple trainings

##***Default table ordering - greatest to smallest?***##

#for FY19 report, all tables are filtered for just current FY
#will want to group by FY in the future, for some

kable(RegistDemo %>%
  filter(Attended=='Yes', FiscalYear==FYshort) %>%
  group_by(Age) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Age Breakdown of Training Participants") %>%
   kable_styling(full_width = F)
```
```{r label = ethnicity, echo = FALSE}
#race/ethnicity is in the DIS, but we have more detail in registrations, so including here
kable(RegistDemo %>%
  filter(Attended=='Yes', FiscalYear==FYshort) %>%
  group_by(Ethnicity) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Ethnicity Breakdown of Training Participants") %>%
   kable_styling(full_width = F)
```
``` {r label = County, echo = FALSE}
kable(RegistDemo %>%
  filter(Attended=='Yes', FiscalYear==FYshort) %>%
  group_by(County) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Geographic Representation of Training Participants") %>%
   kable_styling(full_width = F)
```
``` {r label = experience, echo = FALSE}
kable(RegistDemo %>%
  filter(Attended=='Yes', FiscalYear==FYshort) %>%
  group_by('Years of Experience' = Experience) %>%
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Professional Experience of Training Participants") %>%
   kable_styling(full_width = F)
```
``` {r label = reasonattend, echo = FALSE}
kable(RegistDemo %>%
        filter(Attended=='Yes', FiscalYear==FYshort) %>%
        group_by(`Reason for Attending`) %>%
        summarise(n = n()) %>%
        mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Training Participants' Reason for Attending") %>%
  kable_styling(full_width = F)
```
``` {r label = role, echo = FALSE}
kable(RegistDemo %>%
        filter(Attended=='Yes', FiscalYear==FYshort) %>%
        group_by(Role) %>%
        summarise(n = n()) %>%
        mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Training Participants' Role") %>%
  kable_styling(full_width = F)
```
``` {r label = clinicalAllied, echo = FALSE}
kable(RegistDemo %>%
        filter(Attended=='Yes', FiscalYear==FYshort, !is.na(ClinicalProfessional)) %>%
        group_by("Clinical Professional?" = ClinicalProfessional) %>%
        summarise(n = n()) %>%
        mutate(Percent = (n / sum(n)),Percent=scales::percent(Percent)), caption = "Clinical and Allied Professional Breakdown of Training Participants") %>%
  kable_styling(full_width = F)

#number of distinct organizations represented at trainings
##**this will require re-naming organizations. **need to decide the best way to do this
```



